<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>OTP Verification</title>
    <link rel="shortcut icon" href="./images/home-fav-icon.png" type="image/x-icon" />
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- External CSS file -->
    <link rel="stylesheet" href="../styles/styles.css">
    <style>
        .otp-input {
            width: 3rem;
            height: 3rem;
            text-align: center;
            font-size: 1.5rem;
            font-weight: bold;
        }
        
        .otp-input:focus {
            outline: none;
            ring: 2px;
            ring-color: #3b82f6;
            border-color: #3b82f6;
        }
        
        @media (max-width: 640px) {
            .otp-input {
                width: 2.5rem;
                height: 2.5rem;
                font-size: 1.25rem;
            }
        }
    </style>
</head>
<body class="bg-gray-100">
    <div class="mobile-container">
        <!-- Header -->
        <div class="flex flex-col items-center px-6 pt-8 pb-6">
            <div class="w-[90px] h-[100px] mb-8">
                <img class="w-full h-full" src="../assets/logo.png" alt="Logo" />
            </div>
            <h1 class="text-2xl text-gray-900">Enter OTP</h1>
            <p class="text-gray-500 mt-2 text-center">We've sent a 6-digit code to your email</p>
        </div>
            
        <!-- Form Container -->
        <div class="px-6 pb-8">
            <form id="otpForm">
                <div class="space-y-6">
                    <!-- OTP Input Fields -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-4">Verification Code</label>
                        <div class="flex justify-center space-x-2 sm:space-x-3">
                            <input type="text" maxlength="1" class="otp-input input-field rounded-lg" data-index="0">
                            <input type="text" maxlength="1" class="otp-input input-field rounded-lg" data-index="1">
                            <input type="text" maxlength="1" class="otp-input input-field rounded-lg" data-index="2">
                            <input type="text" maxlength="1" class="otp-input input-field rounded-lg" data-index="3">
                            <input type="text" maxlength="1" class="otp-input input-field rounded-lg" data-index="4">
                            <input type="text" maxlength="1" class="otp-input input-field rounded-lg" data-index="5">
                        </div>
                        <span class="text-red-500 text-xs hidden mt-2 block" id="otp-error">Please enter the complete verification code</span>
                    </div>
                    
                    <!-- Timer and Resend Link -->
                    <div class="text-center">
                        <p class="text-sm text-gray-600">
                            Didn't receive the code? 
                            <button type="button" id="resendBtn" class="font-medium text-blue-500 hover:text-blue-600 disabled:text-gray-400 disabled:cursor-not-allowed" disabled>
                                Resend OTP
                            </button>
                        </p>
                        <p class="text-xs text-gray-500 mt-1">
                            Resend available in <span id="timer">60</span> seconds
                        </p>
                    </div>
                </div>
                
                <!-- Navigation Buttons -->
                <div class="mt-8 space-y-3">
                    <button type="submit" id="verifyBtn" class="w-full bg-[#1b1e20] text-white py-3 px-4 rounded-[4px] font-medium transition-colors">
                        Verify OTP
                    </button>
                    <div class="text-center mt-4">
                        <a href="forgot-password.html" class="text-sm text-gray-600 hover:text-gray-900">
                            Back to Forgot Password
                        </a>
                    </div>
                </div>
            </form>
        </div>
    </div>
 
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Elements
            const otpForm = document.getElementById('otpForm');
            const otpInputs = document.querySelectorAll('.otp-input');
            const verifyBtn = document.getElementById('verifyBtn');
            const resendBtn = document.getElementById('resendBtn');
            const timerElement = document.getElementById('timer');
            const otpError = document.getElementById('otp-error');
            
            let countdown = 60;
            let timerInterval;
            
            // Initialize OTP inputs
            function initializeOtpInputs() {
                otpInputs.forEach((input, index) => {
                    input.addEventListener('input', (e) => {
                        const value = e.target.value;
                        
                        // Only allow numbers
                        if (!/^\d*$/.test(value)) {
                            e.target.value = '';
                            return;
                        }
                        
                        // Move to next input if current is filled
                        if (value && index < otpInputs.length - 1) {
                            otpInputs[index + 1].focus();
                        }
                        
                        // Hide error when user starts typing
                        if (otpError.classList.contains('hidden') === false) {
                            otpError.classList.add('hidden');
                        }
                    });
                    
                    input.addEventListener('keydown', (e) => {
                        // Move to previous input on backspace if current is empty
                        if (e.key === 'Backspace' && !e.target.value && index > 0) {
                            otpInputs[index - 1].focus();
                        }
                    });
                    
                    // Handle paste event
                    input.addEventListener('paste', (e) => {
                        e.preventDefault();
                        const pastedData = e.clipboardData.getData('text').slice(0, 6);
                        const digits = pastedData.split('');
                        
                        digits.forEach((digit, i) => {
                            if (i < otpInputs.length && /^\d$/.test(digit)) {
                                otpInputs[i].value = digit;
                            }
                        });
                        
                        // Focus the last filled input or the next empty one
                        const lastFilledIndex = Math.min(digits.length - 1, otpInputs.length - 1);
                        otpInputs[lastFilledIndex].focus();
                    });
                });
            }
            
            // Start countdown timer
            function startTimer() {
                resendBtn.disabled = true;
                countdown = 60;
                updateTimerDisplay();
                
                timerInterval = setInterval(() => {
                    countdown--;
                    updateTimerDisplay();
                    
                    if (countdown <= 0) {
                        clearInterval(timerInterval);
                        resendBtn.disabled = false;
                        timerElement.textContent = '0';
                    }
                }, 1000);
            }
            
            function updateTimerDisplay() {
                timerElement.textContent = countdown;
            }
            
            // Get OTP value
            function getOtpValue() {
                return Array.from(otpInputs).map(input => input.value).join('');
            }
            
            // Validate OTP
            function validateOtp() {
                const otp = getOtpValue();
                
                if (otp.length !== 6) {
                    otpError.textContent = 'Please enter the complete 6-digit code';
                    otpError.classList.remove('hidden');
                    return false;
                }
                
                otpError.classList.add('hidden');
                return true;
            }
            
            // Form submission
            otpForm.addEventListener('submit', function(e) {
                e.preventDefault();
                
                if (validateOtp()) {
                    const otp = getOtpValue();
                    
                    // Disable button to prevent multiple submissions
                    verifyBtn.disabled = true;
                    verifyBtn.textContent = 'Verifying...';
                    
                    // Simulate API call
                    setTimeout(() => {
                        // For demo purposes, we'll accept any 6-digit code
                        // In a real application, you would verify the OTP with your backend
                        
                        // Simulate success
                        alert('OTP verified successfully! Redirecting to reset password page...');
                        window.location.href = 'login.html';
                        
                        // Reset button in case of error
                        verifyBtn.disabled = false;
                        verifyBtn.textContent = 'Verify OTP';
                    }, 1500);
                }
            });
            
            // Resend OTP
            resendBtn.addEventListener('click', function() {
                // Disable button temporarily
                resendBtn.disabled = true;
                resendBtn.textContent = 'Sending...';
                
                // Simulate API call
                setTimeout(() => {
                    alert('A new OTP has been sent to your email');
                    startTimer();
                    resendBtn.textContent = 'Resend OTP';
                    
                    // Clear existing OTP inputs
                    otpInputs.forEach(input => input.value = '');
                    otpInputs[0].focus();
                }, 1500);
            });
            
            // Initialize
            initializeOtpInputs();
            startTimer();
            
            // Focus first input
            otpInputs[0].focus();
        });
    </script>
</body>
</html>